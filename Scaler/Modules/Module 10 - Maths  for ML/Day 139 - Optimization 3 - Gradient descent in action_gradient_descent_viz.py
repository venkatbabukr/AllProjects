# -*- coding: utf-8 -*-
"""gradient_descent_viz.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13R-QyynRFp3uRwJiLRDEIRSCacvkEn53
"""

import numpy as np

def get_partials(func, x, y):
  delta = 0.0001
  fx = (func(x + delta, y) - func(x, y)) / delta
  fy = (func(x, y + delta) - func(x, y)) / delta
  return fx, fy

func = lambda x, y: x**2 + y**2

get_partials(func, 3, 4)

#creating a 2D grid
def get_grid(axis_lim):
    x= np.linspace(-axis_lim,axis_lim,20)
    y= np.linspace(-axis_lim,axis_lim,20)
    g1,g2 = np.meshgrid(x,y)
    return g1,g2

axis_lim = 10
g1, g2 = get_grid(axis_lim)

#getting gradients for all the points in the 2d grid defined above
def get_partials_from_grid(func,g1,g2):
    U = np.zeros(g1.shape) # df/dx
    V = np.zeros(g2.shape) # df/dy
    for rows_id,(row_x,row_y) in enumerate(zip(g1,g2)):
        for col_id,(x,y) in enumerate(zip(row_x,row_y)):
            fx,fy = get_partials(func, x, y)
            U[rows_id,col_id] = fx
            V[rows_id,col_id] = fy
    return U,V

import matplotlib.pyplot as plt

def plot_gradients(g1,g2,U,V):
    fig,ax=plt.subplots()
    q=ax.quiver(g1,g2,U,V)
    plt.show()

func = lambda x,y : x**2 + y**2
axis_lim = 10
g1,g2 = get_grid(axis_lim)
U,V = get_partials_from_grid(func,g1,g2)
plot_gradients(g1,g2,U,V)

func = lambda x,y : x**2 + y**2
axis_lim = 10
g1,g2 = get_grid(axis_lim)
U,V = get_partials_from_grid(func,g1,g2)
plot_gradients(g1,g2,-U,-V)

