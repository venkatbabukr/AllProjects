# -*- coding: utf-8 -*-
"""GD-demo

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1p_W4n9QDh7_aCErXb32IipZV-PPBSLQ7
"""

import numpy as np
from matplotlib import pyplot as plt
import seaborn as sns

def f(x):
    # try changing this function.
  return (x-5)**2 + 8

## Plot f(x)
x = np.arange(-10, 20, 0.01)
y = f(x)

plt.figure()
plt.plot(x, y)
plt.show()



# This function takes derivative of f at point x
def derivative(x, f):
  delta = 0.0001
  return (f(x + delta) - f(x)) / delta

# This function does exactly one update to my parameter x
def one_step_gd(x, f, lr): # lr -> learning rate, same as \eta
  grad = derivative(x, f)
  new_x = x - lr * grad
  new_fx = f(new_x)
  return new_x, new_fx, grad

derivative(2, f)

derivative(10, f)

# initialization...
x = 10

x, _, _ = one_step_gd(x, f, 0.1)
print(x)

x, _, _ = one_step_gd(x, f, 0.1)
print(x)

x, _, _ = one_step_gd(x, f, 0.1)
print(x)

x, _, _ = one_step_gd(x, f, 0.1)
print(x)

for _ in range(50):
    x, _, _ = one_step_gd(x, f, 0.1)
print(x)



x = -8
x, _, _ = one_step_gd(x, f, 0.1)
print(x)

for _ in range(50):
    x, _, _ = one_step_gd(x, f, 0.1)
print(x)



## Define the initial random guess
x0 = -9
num_steps = 0 # Same as t in the update equation

# Let us save all our steps.
xs = []
fxs = []
grads = []

## Lets plot!!
plt.figure()

# First, plot the function
x = np.arange(-10, 20, 0.01)
y = f(x)
plt.plot(x, y)

# Now apply gradient descent
new_x, new_fx, grad = one_step_gd(x0, f, 0.1)
xs.append(new_x)
fxs.append(new_fx)
grads.append(grad)
num_steps += 1

# Next, plot the old guess and the gradient at that point
t_c = f(x0) - grads[-1] * x0
delta = 2.
t_x = np.arange(x0 - delta, x0 + delta, 0.01)
t_y = grads[-1] * t_x + t_c
plt.plot(t_x, t_y, color="black")

# Next, plot the other guesses
for i in range(num_steps-1):
  plt.plot(xs[i], fxs[i], marker="o", markersize=5, markeredgecolor="green", markerfacecolor="green")

plt.plot(x0, f(x0), marker="o", markersize=5, markeredgecolor="red", markerfacecolor="red")
plt.plot(xs[-1], fxs[-1], marker="o", markersize=5, markeredgecolor="orange", markerfacecolor="orange")

print(new_x)
x0 = new_x
plt.show()





